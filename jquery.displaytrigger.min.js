/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.3.1
 * @updated 2013/05/31
 * @author falsandtru  http://fat.main.jp/  http://sa-kusaku.sakura.ne.jp/
 * @Compressor Closure Compiler
 */
(function(){function u(u){function w(b,a,c,e){var q=window,r=document,r=c===q?r:c,g=!1,h,n;h=jQuery(a.trigger,r);n=h.eq(a.index);var j=jQuery(e).scrollTop(),k=a.height[e===q?"window":"element"],d=j===k?a.direction:j<k?-1:1,k=Math.abs(j-k);a.direction!==d&&(a.turn=!0,a.end=!1,a.direction=d,a.index=0>a.index?0:h.length<=a.index?h.length-1:a.index,n=h.eq(a.index));a.distance=0===k?a.distance:k;a.height[e===q?"window":"element"]=j;a.end=n[0]?!1:a.end;-1===a.direction&&a.length<h.length&&(a.turn=!1,a.end=
!1);a.length=h.length;switch(!0){case !h.length:break;case 0===a.step&&!n[0]:a.index+=-1;return;case 0>a.index:a.index=0;a.end=!0;break;case h.length<=a.index:a.index=h.length-1;a.end=!0;break;case a.beforehand>a.index&&!jQuery.data(n[0],a.nss.data+"-fired"):g=!0;break;default:if(a.end)break;if(!a.multi&&jQuery.data(n[0],a.nss.data+"-fired"))break;var k=jQuery(q).scrollTop(),f=jQuery(q).height(),j=n.offset().top,d=n.height(),l=0>a.direction?0:1,l=-1<=a.ahead[l]&&1>=a.ahead[l]?parseInt(f*a.ahead[l]):
parseInt(a.ahead[l]),m,p;switch(a.mode){case "border":g=k+(1===a.direction?-l:f+l);m=g>=j;p=g<=j+d;g=a.turn&&(1===a.direction?g-a.distance>j:g+a.distance<j+d)?!1:a.skip?m&&p:1===a.direction?m:p;break;case "toggle":break;case "hide":break;default:m=k>=j-f-l,p=k<=j+d+l,g=a.turn&&a.multi&&(1===a.direction?k-a.distance>j-f-l:k+a.distance<j+d+l)?!1:a.skip?m&&p:1===a.direction?m:p}}g&&(jQuery.data(n[0],a.nss.data+"-fired",!0),a.count+=1,a.callback.apply(n[0],[b,a.parameter,{index:a.index,length:h.length,
direction:a.direction}]));if(!h.length||a.terminate&&!a.multi&&0!==a.step&&a.count>=h.length){m=0;jQuery(c).unbind(a.nss.displaytrigger);jQuery(e).unbind(a.nss.scroll).unbind(a.nss.resize);jQuery.removeData(r,a.nss.data);for(r=0;p=a.context[r];r++)m+=jQuery.data(p,a.nss.data)?1:0;!m&&!a.context[0]===q&&jQuery(q).unbind(a.nss.scroll).unbind(a.nss.resize);s[a.id]=v}else if(!a.end&&!g&&isFinite(l)&&(1===a.direction?!m:!p))a.turn=!1;else if(a.index+=0===a.step&&!g?a.direction:0===a.step&&-1===a.direction?
a.direction:a.step*a.direction,!a.end)return arguments.callee.apply(this,arguments)}if("function"===typeof this)return arguments.callee.apply(jQuery(t),arguments);var d=window.validator instanceof Object?window.validator:!1;(d=d?d.clone({name:"jquery.displaytrigger.js",base:!0}):d)&&d.start();d&&d.test("++",1,0,"displaytrigger()");var b=jQuery.extend(!0,{},{id:0,gns:"displaytrigger",ns:v,trigger:v,callback:function(){},parameter:[],ahead:0,beforehand:0,step:1,multi:!1,skip:!1,expand:!0,delay:300,
suspend:-100,mode:"show",terminate:!0,reset:!0},u),f=[b.gns].concat(b.ns||[]);b.reset&&jQuery.extend(!0,b,{nss:{displaytrigger:f.join("."),scroll:["scroll"].concat(f.join(":")).join("."),resize:["resize"].concat(f.join(":")).join("."),data:f.join(":"),array:f},context:this,scope:this[0]===t?jQuery(x):jQuery(this),index:0,length:0,ahead:typeof b.ahead in{string:0,number:0}?[b.ahead,b.ahead]:b.ahead,count:0,height:{},direction:1,distance:0,turn:!1,end:!1,suspend:1<=b.suspend?b.suspend:0<=b.suspend?
parseInt(b.delay*b.suspend):Math.min(0,b.delay+b.suspend),reset:!1,queue:[]});if(b.scope.length&&b.scope.find(b.trigger).length&&arguments.length)for(var c=b,b=0;f=c.context[b];b++)c.id=s.length,c.height.window=0,c.height.element=0,s.push(jQuery.extend(!0,{},c)),jQuery(f).unbind(c.nss.displaytrigger).bind(c.nss.displaytrigger,c.id,function(b,a,c){var e=s[b.data],d,f=this,g=arguments.callee;if(!e.delay||!a)w(b,e,f,a||t);else{for(;d=e.queue.shift();)clearTimeout(d);d=setTimeout(function(){if(e){for(;d=
e.queue.shift();)clearTimeout(d);w(b,e,f,a||t)}},e.delay);e.queue.push(d)}e.suspend&&!c&&(jQuery(this).unbind(e.nss.displaytrigger),setTimeout(function(){e&&jQuery(this).bind(e.nss.displaytrigger,e.id,g).trigger(e.nss.displaytrigger,[a,!0])},e.suspend))}),jQuery.data(f,c.nss.data,!0),jQuery(f).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(b){b=s[b.data];jQuery(this).trigger(b.nss.displaytrigger,[this])}),0===b&&jQuery(t).filter(function(){return c.context[0]===t||c.expand}).unbind(c.nss.resize).bind(c.nss.resize,
c.id,function(b){b=s[b.data];b.context.trigger(b.nss.displaytrigger,[this])}).filter(function(){return c.context[0]!==t}).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(b){b=s[b.data];b.context.trigger(b.nss.displaytrigger,[this])});d&&d.end();return this}if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;var v=void 0,t=window,x=document,s=["settings"];jQuery.fn.displaytrigger=u;jQuery.displaytrigger=u;u=null}})();
