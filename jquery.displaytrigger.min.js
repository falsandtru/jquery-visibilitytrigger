/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.3.5
 * @updated 2013/08/23
 * @author falsandtru https://github.com/falsandtru/
 * @Compressor Closure Compiler
 */
(function(){function p(p){function x(c){for(var a=0,b;b=c.context[a];a++)c.id=r.length,c.height.window=0,c.height.element=0,r.push(jQuery.extend(!0,{},c)),jQuery(b).unbind(c.nss.displaytrigger).bind(c.nss.displaytrigger,c.id,function(a,c,b){var d=r[a.data],e,k=this,f=arguments.callee;if(d){if(d.delay&&c){for(;e=d.queue.shift();)clearTimeout(e);e=setTimeout(function(){if(d){for(;e=d.queue.shift();)clearTimeout(e);w(a,d,k,c||g)}},d.delay);d.queue.push(e)}else w(a,d,k,c||g);d.suspend&&!b&&(jQuery(this).unbind(d.nss.displaytrigger),
setTimeout(function(){d&&jQuery(this).bind(d.nss.displaytrigger,d.id,f).trigger(d.nss.displaytrigger,[c,!0])},d.suspend))}}),jQuery.data(b,c.nss.data,!0),jQuery(b).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(a){(a=r[a.data])&&jQuery(this).trigger(a.nss.displaytrigger,[this])}),0===a&&jQuery(g).filter(function(){return c.context[0]===g||c.expand}).unbind(c.nss.resize).bind(c.nss.resize,c.id,function(a){(a=r[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])}).filter(function(){return c.context[0]!==
g}).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(a){(a=r[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])})}function w(c,a,b,h){var g=window,s=document,s=b===g?s:b,d=!1,e=jQuery(a.trigger,s),k=e.eq(a.index),f=jQuery(h).scrollTop(),l=a.height[h===g?"window":"element"],t=f===l?a.direction:f<l?-1:1,l=Math.abs(f-l);a.direction!==t&&(a.turn=!0,a.end=!1,a.direction=t,a.index=0>a.index?0:e.length<=a.index?e.length-1:a.index,k=e.eq(a.index));a.distance=0===l?a.distance:l;a.height[h===g?"window":
"element"]=f;a.end=k[0]?!1:a.end;-1===a.direction&&a.length<e.length&&(a.turn=!1,a.end=!1);a.length=e.length;switch(!0){case !e.length:break;case 0===a.step&&!k[0]:a.index+=-1;return;case 0>a.index:a.index=0;a.end=!0;break;case e.length<=a.index:a.index=e.length-1;a.end=!0;break;case a.beforehand>a.index&&!jQuery.data(k[0],a.nss.data+"-fired"):d=!0;break;default:if(a.end||k.is(":hidden")||!a.multi&&jQuery.data(k[0],a.nss.data+"-fired"))break;var l=jQuery(g).scrollTop(),p=jQuery(g).height(),f=k.offset().top,
t=k.height(),m=0>a.direction?0:1,m=-1<=a.ahead[m]&&1>=a.ahead[m]?parseInt(p*a.ahead[m]):parseInt(a.ahead[m]),n,q;switch(a.mode){case "border":d=l+(1===a.direction?-m:p+m);n=d>=f;q=d<=f+t;d=a.turn&&(1===a.direction?d-a.distance>f:d+a.distance<f+t)?!1:a.skip?n&&q:1===a.direction?n:q;break;case "toggle":break;case "hide":break;default:n=l>=f-p-m,q=l<=f+t+m,d=a.turn&&a.multi&&(1===a.direction?l-a.distance>f-p-m:l+a.distance<f+t+m)?!1:a.skip?n&&q:1===a.direction?n:q}}d&&(jQuery.data(k[0],a.nss.data+"-fired",
!0),a.count+=1,a.callback.apply(k[0],[c,a.parameter,{index:a.index,length:e.length,direction:a.direction}]));if(!e.length||a.terminate&&!a.multi&&0!==a.step&&a.count>=e.length){n=0;jQuery(b).unbind(a.nss.displaytrigger);jQuery(h).unbind(a.nss.scroll).unbind(a.nss.resize);jQuery.removeData(s,a.nss.data);for(s=0;q=a.context[s];s++)n+=jQuery.data(q,a.nss.data)?1:0;!n&&!a.context[0]===g&&jQuery(g).unbind(a.nss.scroll).unbind(a.nss.resize);return r[a.id]=v}a.end||d||!isFinite(m)||(1===a.direction?n:q)?
(a.index+=0!==a.step||d?0===a.step&&-1===a.direction?a.direction:a.step*a.direction:a.direction,a.end||arguments.callee.apply(this,arguments)):a.turn=!1}if("function"===typeof this)return arguments.callee.apply(jQuery(g),arguments);var h=window.validator instanceof Object?window.validator:!1;(h=h?h.clone({name:"jquery.displaytrigger.js",base:!0}):h)&&h.start();h&&h.test("++",1,0,"displaytrigger()");var b=jQuery.extend(!0,{},{id:0,gns:"displaytrigger",ns:v,trigger:v,callback:function(){},parameter:[],
ahead:0,beforehand:0,step:1,multi:!1,skip:!1,expand:!0,delay:300,suspend:-100,mode:"show",terminate:!0},p),u=[b.gns].concat(b.ns||[]);jQuery.extend(!0,b,{nss:{displaytrigger:u.join("."),scroll:["scroll"].concat(u.join(":")).join("."),resize:["resize"].concat(u.join(":")).join("."),data:u.join(":"),array:u},context:this,scope:this[0]===g?jQuery(y):jQuery(this),ahead:typeof b.ahead in{string:0,number:0}?[b.ahead,b.ahead]:b.ahead,suspend:1<=b.suspend?b.suspend:0<=b.suspend?parseInt(b.delay*b.suspend):
Math.min(0,b.delay+b.suspend),index:0,length:0,count:0,height:{},direction:1,distance:0,turn:!1,end:!1,queue:[]});b.scope.length&&(b.scope.find(b.trigger).length&&arguments.length)&&x(b);h&&h.end();return this}if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;var v=void 0,g=window,y=document,r=["settings"];jQuery.fn.displaytrigger=p;jQuery.displaytrigger=p;p=null}})();
