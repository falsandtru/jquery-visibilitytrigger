/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT http://opensource.org/licenses/mit-license.php
 * @version 1.6.1
 * @updated 2013/11/23
 * @author falsandtru https://github.com/falsandtru/
 * @Compressor Closure Compiler
 */
(function(d){var p=window,D=document,A=void 0,u=["settings"];d.fn.displaytrigger=d.displaytrigger=function(x){function F(e){!e.multi&&d(e.trigger,e.window?D:e.context).removeData(e.nss.data+"-fired");for(var a=0,f;f=e.context[a];a++)e.id=u.length,e.height=[0,0],u.push(d.extend(!0,{},e)),d(f).unbind(e.nss.displaytrigger).bind(e.nss.displaytrigger,e.id,function(a,b,e){function f(a){if(a.id===d.data(h,a.nss.data))return!0;u[a.id]=A}var c=u[a.data],l,h=this,k=arguments.callee;if(c){if(c.delay&&b){for(;l=
c.queue.shift();)clearTimeout(l);l=setTimeout(function(){if(c){for(;l=c.queue.shift();)clearTimeout(l);f(c)&&c.interval<=(new Date).getTime()-c.timestamp&&E(a,c,h,b||p)}},c.delay);c.queue.push(l)}else f(c)&&(!b||c.interval<=(new Date).getTime()-c.timestamp)&&E(a,c,h,b||p);c.suspend&&!e&&(d(h).unbind(c.nss.displaytrigger),setTimeout(function(){c&&f(c)&&d(h).bind(c.nss.displaytrigger,c.id,k).trigger(c.nss.displaytrigger,[b,!0])},c.suspend))}}),d.data(f,e.nss.data,e.id),d(f).unbind(e.nss.scroll).bind(e.nss.scroll,
e.id,function(a){(a=u[a.data])&&d(this).trigger(a.nss.displaytrigger,[this])}).unbind(e.nss.resize).bind(e.nss.resize,e.id,function(a){(a=u[a.data])&&d(this).trigger(a.nss.displaytrigger,[this])}),0===a&&d(p).filter(function(){return!e.window&&e.expand}).unbind(e.nss.scroll).bind(e.nss.scroll,e.id,function(a){(a=u[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])}).unbind(e.nss.resize).bind(e.nss.resize,e.id,function(a){(a=u[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])})}function E(e,
a,f,k){var b=a.validate?a.validate.clone({name:"jquery.displaytrigger.js - drive()"}):!1;b&&b.start();b&&(b.scope=function(a){return eval(a)});b&&b.test("++",1,[a,window===k],"drive()");b&&b.test("++",1,0,"initialize");var p=window,v=document,v=a.window?v:f,c=!1,l=!1,h=d(a.trigger,v),r=h.eq(a.index),m=d(k).scrollTop(),g=a.height[Number(k===p)],q=m===g?a.direction:m<g?-1:1,g=Math.abs(m-g);b&&b.test("++",1,0,"setting");a.direction!==q&&(a.turn=!0,a.end=!1,a.direction=q,a.index=0>a.index?0:h.length<=
a.index?h.length-1:a.index,r=h.eq(a.index));a.distance=0===g?a.distance:g;a.height[Number(k===p)]=m;a.end=r[0]?!1:a.end;-1===a.direction&&a.length<h.length&&(a.turn=!1,a.end=!1);a.length=h.length;b&&b.test("++",1,a,"switch");switch(!0){case !h.length:b&&b.test("*",1,0,"case !targets.length");break;case 0===a.step&&!r[0]:b&&b.test("*",1,0,"case settings.step === 0 && !target[ 0 ]");a.index+=-1;b&&b.end();return;case 0>a.index:b&&b.test("*",1,0,"case settings.index < 0");a.index=0;a.end=!0;break;case h.length<=
a.index:b&&b.test("*",1,0,"case targets.length <= settings.index");a.index=h.length-1;a.end=!0;break;case a.beforehand>a.index&&(a.multi||!d.data(r[0],a.nss.data+"-fired")):b&&b.test("*",1,0,"case settings.beforehand > settings.index &&");a.beforehand===a.index+1&&(a.beforehand=0);c=!0;break;default:b&&b.test("*",1,0,"default");if(a.end||r.is(":hidden")||!a.multi&&d.data(r[0],a.nss.data+"-fired"))break;b&&b.test("++",1,0,"initialize");var q=d(p),m=q.scrollTop(),q=q.height(),g=d(f),t=a.window?0:g.offset().top,
x=a.window?q:g.outerHeight(!0),g=r.offset().top,w=r.outerHeight(!0),y=Math.max(0,a.direction),B=-1<=a.ahead[0]&&1>=a.ahead[0]?parseInt(q*a.ahead[0],10):parseInt(a.ahead[0],10),C=-1<=a.ahead[1]&&1>=a.ahead[1]?parseInt(q*a.ahead[1],10):parseInt(a.ahead[1],10),y=y?C:B,n,s;b&&b.test("++",1,a.mode,"check");if(a.jump){var z,c=d(h[a.index+a.step*a.jump*a.direction]);z=d(h[a.index-a.step*a.jump*a.direction]);if(c=1===a.direction?z[0]&&z.offset().top>g||c[0]&&c.offset().top<=g:z[0]&&z.offset().top+z.outerHeight(!0)>=
g||c[0]&&c.offset().top+c.outerHeight(!0)<g+w)break}switch(a.mode){case "border":l=m+(1===a.direction?-y:q+y);n=l>=g;s=l<=g+w;b&&b.test("++",1,[l,n,s],"border");c=a.turn&&(1===a.direction?l-a.distance>g:l+a.distance<g+w)?!1:a.skip?n&&s:1===a.direction?n:s;break;case "toggle":b&&b.test("++",1,[],"toggle");break;case "hide":b&&b.test("++",1,[],"hide");break;default:n=q+m>=g-C&&(a.window?!0:t+x>=g-C),l=a.window||k!==p?!1:n&&t>g+w+B,s=m<=g+w+B&&(a.window?!0:t<=g+w+B),c=a.window||k!==p?!1:s&&t+x<g-C,b&&
b.test("++",1,[n,l,s,c],"show"),c=a.turn&&a.multi&&(1===a.direction?m-a.distance+q>g-y:m+a.distance<g+w+y)?!1:a.skip?n&&s:1!==a.direction&&a.multi?s&&!c:n&&!l}l=!0}b&&b.test("/",1,c,"fire");if(c){if(a.interval)if(m=(new Date).getTime(),a.interval<=m-a.timestamp)a.timestamp=m;else return id=setTimeout(function(){a&&d(f).trigger(a.nss.displaytrigger,[k,!0])},Math.max(a.interval-m+a.timestamp,50)),a.queue.push(id),b&&b.end(),a.turn=!1;!a.multi&&++a.count&&d.data(r[0],a.nss.data+"-fired",a.id);!1===a.callback.apply(r[0],
[e,a.parameter,{index:a.index,length:h.length,direction:a.direction}])&&!a.multi&&a.count--&&d.removeData(r[0],a.nss.data+"-fired")&&(c=!1)}b&&b.test("++",1,0,"terminate");if(!h.length||a.terminate&&!a.multi&&0!==a.step&&a.count>=h.length){n=0;b&&b.test("*",1,0,"unbind node event");d(f).unbind(a.nss.displaytrigger).unbind(a.nss.scroll).unbind(a.nss.resize);b&&b.test("++",1,0,"remove data");d.removeData(v,a.nss.data);!a.multi&&h.removeData(a.nss.data+"-fired");for(v=0;h=a.context[v];v++)n+=d.data(h,
a.nss.data)?1:0;b&&b.test("++",1,0,"unbind root event");!n&&!a.window&&a.expand&&d(p).unbind(a.nss.scroll).unbind(a.nss.resize);b&&b.end();return u[a.id]=A}b&&b.test("++",1,0,"exit");if(!a.end&&!c&&l&&(1===a.direction?!n:!s))return b&&b.end(),a.turn=!1;b&&b.test("++",1,0,"increment");a.index+=0!==a.step||c?0===a.step&&-1===a.direction?a.direction:a.multi||a.skip?a.step*a.direction:a.step:a.direction;b&&b.end();a.end||arguments.callee.apply(this,arguments)}if("function"===typeof this)return arguments.callee.apply(d(p),
arguments);var k=window.validator instanceof Object?window.validator.clone({name:"jquery.displaytrigger.js",base:!0}):!1;k&&k.start();k&&k.test("++",1,x,"displaytrigger()");k&&k.test("++",1,0,"initialize");var f=d.extend(!0,{},{id:0,gns:"displaytrigger",ns:A,trigger:A,callback:function(){},parameter:[],ahead:0,beforehand:0,step:1,multi:!1,skip:!1,jump:0,expand:!0,delay:300,suspend:-100,interval:0,mode:"show",terminate:!0},x),t=[f.gns].concat(f.ns||[]);k&&k.test("++",1,0,"overwrite");d.extend(!0,f,
{nss:{displaytrigger:t.join("."),scroll:["scroll"].concat(t.join(":")).join("."),resize:["resize"].concat(t.join(":")).join("."),data:t.join(":"),array:t},window:this[0]===p,context:this,scope:this[0]===p?d(D):d(this),ahead:typeof f.ahead in{string:0,number:0}?[f.ahead,f.ahead]:A,suspend:1<=f.suspend?f.suspend:0<=f.suspend?parseInt(f.delay*f.suspend,10):Math.max(0,parseInt(f.delay+f.suspend,10)),index:0,length:0,count:0,height:{},direction:1,distance:0,turn:!1,end:!1,queue:[],timestamp:0,options:x,
validate:k});k&&k.test("++",1,0,"register");f.scope.length&&f.scope.find(f.trigger).length&&arguments.length&&F(f);k&&k.end();return this}})(jQuery);
