/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.1.15
 * @updated 2013/04/27
 * @author falsandtru  http://fat.main.jp/  http://sa-kusaku.sakura.ne.jp/
 * @Compressor Closure Compiler
 */
(function(){function m(m){function v(c,a,b,q){var e=b===f?w:b,d=!1,h,k;h=jQuery(a.trigger,e);k=h.eq(a.index);switch(!0){case !h.length:break;case 0===a.step&&!k[0]:a.index+=-1;return;case 0>a.index:return a.index=0,a.end=!0,arguments.callee.apply(this,arguments);case a.index>=h.length:return a.index=h.length-1,a.end=!0,arguments.callee.apply(this,arguments);case a.beforehand>a.index&&!jQuery.data(k[0],a.nss.data+"-fired"):d=!0;break;default:var j=jQuery(q).scrollTop(),g=a.height[q===f?"window":"element"],
p=j===g?a.direction:j<g?-1:1,g=-1===p?g-j:j-g;a.direction!==p&&(a.turn=!0,a.end=!1,a.direction=p,k=h.eq(a.index));a.distance=0===g?a.distance:g;a.height[q===f?"window":"element"]=j;if(a.end)break;var j=jQuery(f).scrollTop(),g=k.offset().top,m=jQuery(f).height(),s=k.height(),l=0>p?0:1,l=-1<=a.ahead[l]&&1>=a.ahead[l]?parseInt(s*a.ahead[l]):parseInt(a.ahead[l]),t=j>=g-m-l,u=j<=g+s+l;if(a.multi||!jQuery.data(k[0],a.nss.data+"-fired"))d=a.turn&&a.multi&&(-1===p?j+a.distance<=g+s+l:j-a.distance>=g-m-l)?
!1:a.skip?t&&u:-1===p?u:t;if(!d&&!(-1===a.direction?u:t)){a.turn=!1;return}}d&&(jQuery.data(k[0],a.nss.data+"-fired",!0),a.count+=1,a.callback.apply(k[0],[c,a.parameter,{index:a.index,direction:a.direction}]));if(!h.length||a.terminate&&!a.multi&&0!==a.step&&a.count>=h.length){d=0;jQuery(b).unbind(a.nss.displaytrigger);jQuery(q).unbind(a.nss.scroll).unbind(a.nss.resize);jQuery.removeData(e,a.nss.data);for(e=0;h=a.context[e];e++)d+=jQuery.data(h,a.nss.data)?1:0;!d&&!a.context[0]===f&&jQuery(f).unbind(a.nss.scroll).unbind(a.nss.resize);
n[a.id]=r}else return a.index+=0===a.step&&!d?a.direction:0===a.step&&-1===a.direction?a.direction:a.step*a.direction,a.end?r:arguments.callee.apply(this,arguments)}if("function"===typeof this)return arguments.callee.apply(jQuery(f),arguments);var e="object"===typeof window.validator?window.validator:!1;(e=e?e.clone({name:"jquery.displaytrigger.js",base:!0}):e)&&e.start();e&&e.test(1,1,0,"plugin load");var b=jQuery.extend(!0,{},{id:0,gns:"displaytrigger",ns:r,trigger:r,callback:function(){},parameter:[],
ahead:0,beforehand:0,step:1,multi:!1,skip:!1,expand:!0,delay:300,terminate:!0,reset:!0},m),d=[b.gns].concat(b.ns||[]);b.reset&&jQuery.extend(!0,b,{nss:{displaytrigger:d.join("."),scroll:["scroll"].concat(d.join(":")).join("."),resize:["resize"].concat(d.join(":")).join("."),data:d.join(":"),array:d},context:this,scope:this[0]===f?jQuery(w):jQuery(this),index:0,ahead:typeof b.ahead in{string:1,number:1}?[b.ahead,b.ahead]:b.ahead,count:0,height:{},direction:1,distance:0,turn:!1,end:!1,reset:!1,queue:[]});
if(b.scope.length&&b.scope.find(b.trigger).length&&arguments.length)for(var c=b,b=0;d=c.context[b];b++)c.id=n.length,c.height.window=0,c.height.element=0,n.push(jQuery.extend(!0,{},c)),jQuery(d).unbind(c.nss.displaytrigger).bind(c.nss.displaytrigger,c.id,function(c,a){var b=n[c.data],d,e=this;if(!b.delay||!a)v(c,b,e,a||f);else{for(;d=b.queue.shift();)clearTimeout(d);d=setTimeout(function(){if(b){for(;d=b.queue.shift();)clearTimeout(d);v(c,b,e,a||f)}},b.delay);b.queue.push(d)}}),jQuery.data(d,c.nss.data,
!0),jQuery(d).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(b){b=n[b.data];jQuery(this).trigger(b.nss.displaytrigger,[this])}),0===b&&jQuery(f).filter(function(){return c.context[0]===f||c.expand}).unbind(c.nss.resize).bind(c.nss.resize,c.id,function(b){b=n[b.data];b.context.trigger(b.nss.displaytrigger,[this])}).filter(function(){return c.context[0]!==f}).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(b){b=n[b.data];b.context.trigger(b.nss.displaytrigger,[this])});e&&e.end();return this}
if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;var r=void 0,f=window,w=document,n=["settings"];jQuery.fn.displaytrigger=m;jQuery.displaytrigger=m;m=null}})();
