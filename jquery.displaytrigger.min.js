/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.1.4
 * @updated 2013/04/12
 * @author falsandtru  http://fat.main.jp/  http://sa-kusaku.sakura.ne.jp/
 * @Compressor Closure Compiler
 */
(function(){function j(j){function v(c,b,f){var g=window,a=document,d=b===g?a:b,m=!1,k,n;if(a=e[c.data]){k=jQuery(a.trigger,d);n=k.eq(a.index);switch(!0){case !k.length:break;case a.terminate&&(0>a.index||a.index>=k.length):break;case 0>a.index:return a.index=0,a.end=!0,e[a.id]=a,arguments.callee.apply(b,arguments);case a.index>=k.length:return a.index=k.length-1,a.end=!0,e[a.id]=a,arguments.callee.apply(b,arguments);case a.beforehand>a.index&&!jQuery.data(n.get(0),a.nss.data+"-fired"):m=!0;break;
default:var l=jQuery(f).scrollTop(),h=a.height[f===g?"window":"element"],j=l===h?a.direction:l<h?-1:1,h=-1===j?h-l:l-h;a.direction!==j&&(a.turn=!0,a.end=!1,a.direction=j,n=k.eq(a.index));a.distance=0===h?a.distance:h;a.height[f===g?"window":"element"]=l;if(a.end)break;var l=jQuery(g).scrollTop(),h=n.offset().top,q=jQuery(g).height(),p=n.height(),r=-1<a.ahead&&1>a.ahead?p*a.ahead:a.ahead,t=l>=h-q-r,u=l<=h+p+r;if(!a.once||!jQuery.data(n.get(0),a.nss.data+"-fired"))m=a.turn&&!a.once&&(-1===j?l+a.distance<=
h+p+r:l-a.distance>=h-q-r)?!1:a.skip?t&&u:-1===j?u:t;if(!m&&!(-1===a.direction?u:t)){a.turn=!1;e[a.id]=a;return}}m&&(jQuery.data(n.get(0),a.nss.data+"-fired",!0),a.callback.apply(n.get(0),[c,a.parameter,a.index,a.direction]));if(a.terminate&&(m&&(0===a.index&&0>a.step||a.index===k.length-1&&0<a.step)||!k.length)){m=0;jQuery(b).unbind(a.nss.displaytrigger).unbind(a.nss.scroll);jQuery.removeData(d,a.nss.data);for(d=0;k=a.scope[d];d++)m+=jQuery.data(k,a.nss.data)?1:0;m||f===g?null:jQuery(g).unbind(a.nss.scroll).unbind(a.nss.resize);
e[a.id]=s}else return a.index+=-1===a.direction?-a.step:a.step,e[a.id]=a,a.end?s:arguments.callee.apply(b,arguments)}}if("function"===typeof this)return arguments.callee.apply(jQuery(d),arguments);var b=jQuery.extend(!0,{},{id:0,gns:"displaytrigger",ns:s,trigger:s,callback:function(){},parameter:[],ahead:0,beforehand:0,index:0,step:1,once:!0,skip:!1,expand:!0,delay:300,terminate:!0,reset:!0},j);b.reset&&jQuery.extend(!0,b,{nss:{scroll:["scroll",b.gns+(b.ns?":"+b.ns:"")].join("."),displaytrigger:""+
(b.gns+(b.ns?"."+b.ns:"")),resize:["resize",b.gns+(b.ns?":"+b.ns:"")].join("."),data:b.gns+(b.ns?":"+b.ns:"")},scope:this.get(0)===d?jQuery(p):jQuery(this),index:0,height:{},direction:1,distance:0,turn:!1,end:!1,reset:!1,queue:[]});if(!b.scope.length||!b.scope.find(b.trigger).length||!arguments.length)return this;var c=b;c.height.window=0;jQuery(d).unbind(c.nss.resize);for(var b=0,q;q=c.scope[b];b++)c.height.element=0,c.id=e.length,e.push(jQuery.extend(!0,{},c)),jQuery.data(q,c.nss.data,c.id),jQuery(q===
p?d:q).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(b){b=e[b.data];jQuery(this).trigger(b.nss.displaytrigger,[this])}).unbind(c.nss.displaytrigger).bind(c.nss.displaytrigger,c.id,function(b,c){var f=e[b.data],g,a;a=this;f.delay?(g=setTimeout(function(){for(;g=f.queue.shift();)clearTimeout(g);e[f.id]=f;v(b,a,c||d)},f.interval),f.queue.push(g),e[f.id]=f):v(b,a,c||d)});jQuery(d).unbind(c.nss.resize).bind(c.nss.resize,c.id,function(b){b=e[b.data];b.scope.trigger(b.nss.displaytrigger,[this])}).filter(function(){return c.expand&&
p!==c.scope.get(0)}).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(b){b=e[b.data];b.scope.trigger(b.nss.displaytrigger,[this])});return this}if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;var s=void 0,d=window,p=document,e=["settings"];d.jQuery.fn.displaytrigger=j;d.jQuery.displaytrigger=j;j=null}})();
