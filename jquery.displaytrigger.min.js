/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.3.4
 * @updated 2013/06/27
 * @author falsandtru  http://fat.main.jp/  http://sa-kusaku.sakura.ne.jp/
 * @Compressor Closure Compiler
 */
(function(){function u(u){function w(c,a,b,e){var q=window,r=document,r=b===q?r:b,g=!1,j=jQuery(a.trigger,r),n=j.eq(a.index),h=jQuery(e).scrollTop(),k=a.height[e===q?"window":"element"],d=h===k?a.direction:h<k?-1:1,k=Math.abs(h-k);a.direction!==d&&(a.turn=!0,a.end=!1,a.direction=d,a.index=0>a.index?0:j.length<=a.index?j.length-1:a.index,n=j.eq(a.index));a.distance=0===k?a.distance:k;a.height[e===q?"window":"element"]=h;a.end=n[0]?!1:a.end;-1===a.direction&&a.length<j.length&&(a.turn=!1,a.end=!1);
a.length=j.length;switch(!0){case !j.length:break;case 0===a.step&&!n[0]:a.index+=-1;return;case 0>a.index:a.index=0;a.end=!0;break;case j.length<=a.index:a.index=j.length-1;a.end=!0;break;case a.beforehand>a.index&&!jQuery.data(n[0],a.nss.data+"-fired"):g=!0;break;default:if(a.end)break;if(!a.multi&&jQuery.data(n[0],a.nss.data+"-fired"))break;if("none"===n[0].style.display)break;var k=jQuery(q).scrollTop(),f=jQuery(q).height(),h=n.offset().top,d=n.height(),l=0>a.direction?0:1,l=-1<=a.ahead[l]&&1>=
a.ahead[l]?parseInt(f*a.ahead[l]):parseInt(a.ahead[l]),m,p;switch(a.mode){case "border":g=k+(1===a.direction?-l:f+l);m=g>=h;p=g<=h+d;g=a.turn&&(1===a.direction?g-a.distance>h:g+a.distance<h+d)?!1:a.skip?m&&p:1===a.direction?m:p;break;case "toggle":break;case "hide":break;default:m=k>=h-f-l,p=k<=h+d+l,g=a.turn&&a.multi&&(1===a.direction?k-a.distance>h-f-l:k+a.distance<h+d+l)?!1:a.skip?m&&p:1===a.direction?m:p}}g&&(jQuery.data(n[0],a.nss.data+"-fired",!0),a.count+=1,a.callback.apply(n[0],[c,a.parameter,
{index:a.index,length:j.length,direction:a.direction}]));if(!j.length||a.terminate&&!a.multi&&0!==a.step&&a.count>=j.length){m=0;jQuery(b).unbind(a.nss.displaytrigger);jQuery(e).unbind(a.nss.scroll).unbind(a.nss.resize);jQuery.removeData(r,a.nss.data);for(r=0;p=a.context[r];r++)m+=jQuery.data(p,a.nss.data)?1:0;!m&&!a.context[0]===q&&jQuery(q).unbind(a.nss.scroll).unbind(a.nss.resize);s[a.id]=v}else if(!a.end&&!g&&isFinite(l)&&(1===a.direction?!m:!p))a.turn=!1;else if(a.index+=0===a.step&&!g?a.direction:
0===a.step&&-1===a.direction?a.direction:a.step*a.direction,!a.end)return arguments.callee.apply(this,arguments)}if("function"===typeof this)return arguments.callee.apply(jQuery(t),arguments);var d=window.validator instanceof Object?window.validator:!1;(d=d?d.clone({name:"jquery.displaytrigger.js",base:!0}):d)&&d.start();d&&d.test("++",1,0,"displaytrigger()");var c=jQuery.extend(!0,{},{id:0,gns:"displaytrigger",ns:v,trigger:v,callback:function(){},parameter:[],ahead:0,beforehand:0,step:1,multi:!1,
skip:!1,expand:!0,delay:300,suspend:-100,mode:"show",terminate:!0},u),f=[c.gns].concat(c.ns||[]);jQuery.extend(!0,c,{nss:{displaytrigger:f.join("."),scroll:["scroll"].concat(f.join(":")).join("."),resize:["resize"].concat(f.join(":")).join("."),data:f.join(":"),array:f},context:this,scope:this[0]===t?jQuery(x):jQuery(this),index:0,length:0,ahead:typeof c.ahead in{string:0,number:0}?[c.ahead,c.ahead]:c.ahead,count:0,height:{},direction:1,distance:0,turn:!1,end:!1,suspend:1<=c.suspend?c.suspend:0<=
c.suspend?parseInt(c.delay*c.suspend):Math.min(0,c.delay+c.suspend),queue:[]});if(c.scope.length&&c.scope.find(c.trigger).length&&arguments.length)for(var b=c,c=0;f=b.context[c];c++)b.id=s.length,b.height.window=0,b.height.element=0,s.push(jQuery.extend(!0,{},b)),jQuery(f).unbind(b.nss.displaytrigger).bind(b.nss.displaytrigger,b.id,function(b,a,c){var e=s[b.data],d,f=this,g=arguments.callee;if(!e.delay||!a)w(b,e,f,a||t);else{for(;d=e.queue.shift();)clearTimeout(d);d=setTimeout(function(){if(e){for(;d=
e.queue.shift();)clearTimeout(d);w(b,e,f,a||t)}},e.delay);e.queue.push(d)}e.suspend&&!c&&(jQuery(this).unbind(e.nss.displaytrigger),setTimeout(function(){e&&jQuery(this).bind(e.nss.displaytrigger,e.id,g).trigger(e.nss.displaytrigger,[a,!0])},e.suspend))}),jQuery.data(f,b.nss.data,!0),jQuery(f).unbind(b.nss.scroll).bind(b.nss.scroll,b.id,function(b){b=s[b.data];jQuery(this).trigger(b.nss.displaytrigger,[this])}),0===c&&jQuery(t).filter(function(){return b.context[0]===t||b.expand}).unbind(b.nss.resize).bind(b.nss.resize,
b.id,function(b){b=s[b.data];b.context.trigger(b.nss.displaytrigger,[this])}).filter(function(){return b.context[0]!==t}).unbind(b.nss.scroll).bind(b.nss.scroll,b.id,function(b){b=s[b.data];b.context.trigger(b.nss.displaytrigger,[this])});d&&d.end();return this}if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;var v=void 0,t=window,x=document,s=["settings"];jQuery.fn.displaytrigger=u;jQuery.displaytrigger=u;u=null}})();
