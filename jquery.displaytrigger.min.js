/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.4.4
 * @updated 2013/08/25
 * @author falsandtru https://github.com/falsandtru/
 * @Compressor Closure Compiler
 */
(function(e){var p=window,B=document,x=void 0,q=["settings"];e.fn.displaytrigger=e.displaytrigger=function(C){function D(b){for(var a=0,d;d=b.context[a];a++)b.id=q.length,b.height.window=0,b.height.element=0,q.push(e.extend(!0,{},b)),e(d).unbind(b.nss.displaytrigger).bind(b.nss.displaytrigger,b.id,function(a,b,d){var c=q[a.data],f,h=this,m=arguments.callee;if(c){if(c.delay&&b){for(;f=c.queue.shift();)clearTimeout(f);f=setTimeout(function(){if(c){for(;f=c.queue.shift();)clearTimeout(f);A(a,c,h,b||
p)}},c.delay);c.queue.push(f)}else A(a,c,h,b||p);c.suspend&&!d&&(e(this).unbind(c.nss.displaytrigger),setTimeout(function(){c&&e(this).bind(c.nss.displaytrigger,c.id,m).trigger(c.nss.displaytrigger,[b,!0])},c.suspend))}}),e.data(d,b.nss.data,!0),e(d).unbind(b.nss.scroll).bind(b.nss.scroll,b.id,function(a){(a=q[a.data])&&e(this).trigger(a.nss.displaytrigger,[this])}).unbind(b.nss.resize).bind(b.nss.resize,b.id,function(a){(a=q[a.data])&&e(this).trigger(a.nss.displaytrigger,[this])}),0===a&&e(p).filter(function(){return!b.window&&
b.expand}).unbind(b.nss.scroll).bind(b.nss.scroll,b.id,function(a){(a=q[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])}).unbind(b.nss.resize).bind(b.nss.resize,b.id,function(a){(a=q[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])})}function A(b,a,d,l){var p=window,u=document,u=a.window?u:d,c=!1,f=e(a.trigger,u),h=f.eq(a.index),m=e(l).scrollTop(),g=a.height[l===p?"window":"element"],r=m===g?a.direction:m<g?-1:1,g=Math.abs(m-g);a.direction!==r&&(a.turn=!0,a.end=!1,a.direction=r,a.index=
0>a.index?0:f.length<=a.index?f.length-1:a.index,h=f.eq(a.index));a.distance=0===g?a.distance:g;a.height[l===p?"window":"element"]=m;a.end=h[0]?!1:a.end;-1===a.direction&&a.length<f.length&&(a.turn=!1,a.end=!1);a.length=f.length;switch(!0){case !f.length:break;case 0===a.step&&!h[0]:a.index+=-1;return;case 0>a.index:a.index=0;a.end=!0;break;case f.length<=a.index:a.index=f.length-1;a.end=!0;break;case a.beforehand>a.index&&(a.multi||!a.skip||!e.data(h[0],a.nss.data+"-fired")):a.beforehand===a.index+
1&&(a.beforehand=0);c=!0;break;default:if(a.end||h.is(":hidden")||!a.multi&&a.skip&&e.data(h[0],a.nss.data+"-fired"))break;var k=e(p),m=k.scrollTop(),r=k.outerHeight(!0),k=e(d),v=a.window?0:k.offset().top,t=k.outerHeight(!0),g=h.offset().top,w=h.outerHeight(!0),k=Math.max(0,a.direction),y=-1<=a.ahead[0]&&1>=a.ahead[0]?parseInt(r*a.ahead[0]):parseInt(a.ahead[0]),z=-1<=a.ahead[1]&&1>=a.ahead[1]?parseInt(r*a.ahead[1]):parseInt(a.ahead[1]),k=k?z:y,n,s;switch(a.mode){case "border":c=m+(1===a.direction?
-k:r+k);n=c>=g;s=c<=g+w;c=a.turn&&(1===a.direction?c-a.distance>g:c+a.distance<g+w)?!1:a.skip?n&&s:1===a.direction?n:s;break;case "toggle":break;case "hide":break;default:n=r+m>=g-z&&(a.window?!0:v+t>=g-z),c=a.window?!1:n&&v>g+w+y,s=m<=g+w+y&&(a.window?!0:v<=g+w+y),v=a.window?!1:s&&v+t<g-z,c=a.turn&&a.multi&&(1===a.direction?m-a.distance+r>g-k:m+a.distance<g+w+k)?!1:a.skip?n&&s:1===a.direction?n&&!c:s&&!v&&a.multi}}c&&(!a.multi&&++a.count&&a.skip&&e.data(h[0],a.nss.data+"-fired",!0),a.callback.apply(h[0],
[b,a.parameter,{index:a.index,length:f.length,direction:a.direction}]));if(!f.length||a.terminate&&!a.multi&&0!==a.step&&a.count>=f.length){n=0;e(d).unbind(a.nss.displaytrigger).unbind(a.nss.scroll).unbind(a.nss.resize);e.removeData(u,a.nss.data);!a.multi&&a.skip&&f.removeData(a.nss.data+"-fired");for(u=0;f=a.context[u];u++)n+=e.data(f,a.nss.data)?1:0;!n&&!a.window&&a.expand&&e(p).unbind(a.nss.scroll).unbind(a.nss.resize);return q[a.id]=x}a.end||c||!isFinite(k)||(1===a.direction?n:s)?(a.index+=0!==
a.step||c?0===a.step&&-1===a.direction?a.direction:a.step*a.direction:a.direction,a.end||arguments.callee.apply(this,arguments)):a.turn=!1}if("function"===typeof this)return arguments.callee.apply(e(p),arguments);var l=window.validator instanceof Object?window.validator:!1;(l=l?l.clone({name:"jquery.displaytrigger.js",base:!0}):l)&&l.start();l&&l.test("++",1,0,"displaytrigger()");var d=e.extend(!0,{},{id:0,gns:"displaytrigger",ns:x,trigger:x,callback:function(){},parameter:[],ahead:0,beforehand:0,
step:1,multi:!1,skip:!1,expand:!0,delay:300,suspend:-100,mode:"show",terminate:!0},C),t=[d.gns].concat(d.ns||[]);e.extend(!0,d,{nss:{displaytrigger:t.join("."),scroll:["scroll"].concat(t.join(":")).join("."),resize:["resize"].concat(t.join(":")).join("."),data:t.join(":"),array:t},window:this[0]===p,context:this,scope:this[0]===p?e(B):e(this),ahead:typeof d.ahead in{string:0,number:0}?[d.ahead,d.ahead]:x,suspend:1<=d.suspend?d.suspend:0<=d.suspend?parseInt(d.delay*d.suspend):Math.min(0,d.delay+d.suspend),
index:0,length:0,count:0,height:{},direction:1,distance:0,turn:!1,end:!1,queue:[]});d.scope.length&&(d.scope.find(d.trigger).length&&arguments.length)&&D(d);l&&l.end();return this}})(jQuery);
