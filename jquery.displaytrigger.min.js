/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.4.3
 * @updated 2013/08/25
 * @author falsandtru https://github.com/falsandtru/
 * @Compressor Closure Compiler
 */
(function(){function q(q){function A(b){for(var a=0,d;d=b.context[a];a++)b.id=r.length,b.height.window=0,b.height.element=0,r.push(jQuery.extend(!0,{},b)),jQuery(d).unbind(b.nss.displaytrigger).bind(b.nss.displaytrigger,b.id,function(a,b,d){var c=r[a.data],e,g=this,l=arguments.callee;if(c){if(c.delay&&b){for(;e=c.queue.shift();)clearTimeout(e);e=setTimeout(function(){if(c){for(;e=c.queue.shift();)clearTimeout(e);z(a,c,g,b||n)}},c.delay);c.queue.push(e)}else z(a,c,g,b||n);c.suspend&&!d&&(jQuery(this).unbind(c.nss.displaytrigger),
setTimeout(function(){c&&jQuery(this).bind(c.nss.displaytrigger,c.id,l).trigger(c.nss.displaytrigger,[b,!0])},c.suspend))}}),jQuery.data(d,b.nss.data,!0),jQuery(d).unbind(b.nss.scroll).bind(b.nss.scroll,b.id,function(a){(a=r[a.data])&&jQuery(this).trigger(a.nss.displaytrigger,[this])}).unbind(b.nss.resize).bind(b.nss.resize,b.id,function(a){(a=r[a.data])&&jQuery(this).trigger(a.nss.displaytrigger,[this])}),0===a&&jQuery(n).filter(function(){return!b.window&&b.expand}).unbind(b.nss.scroll).bind(b.nss.scroll,
b.id,function(a){(a=r[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])}).unbind(b.nss.resize).bind(b.nss.resize,b.id,function(a){(a=r[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])})}function z(b,a,d,k){var n=window,u=document,u=a.window?u:d,c=!1,e=jQuery(a.trigger,u),g=e.eq(a.index),l=jQuery(k).scrollTop(),f=a.height[k===n?"window":"element"],s=l===f?a.direction:l<f?-1:1,f=Math.abs(l-f);a.direction!==s&&(a.turn=!0,a.end=!1,a.direction=s,a.index=0>a.index?0:e.length<=a.index?e.length-
1:a.index,g=e.eq(a.index));a.distance=0===f?a.distance:f;a.height[k===n?"window":"element"]=l;a.end=g[0]?!1:a.end;-1===a.direction&&a.length<e.length&&(a.turn=!1,a.end=!1);a.length=e.length;switch(!0){case !e.length:break;case 0===a.step&&!g[0]:a.index+=-1;return;case 0>a.index:a.index=0;a.end=!0;break;case e.length<=a.index:a.index=e.length-1;a.end=!0;break;case a.beforehand>a.index&&(a.multi||!a.skip||!jQuery.data(g[0],a.nss.data+"-fired")):a.beforehand===a.index+1&&(a.beforehand=0);c=!0;break;
default:if(a.end||g.is(":hidden")||!a.multi&&a.skip&&jQuery.data(g[0],a.nss.data+"-fired"))break;var h=jQuery(n),l=h.scrollTop(),s=h.outerHeight(!0),h=jQuery(d),v=a.window?0:h.offset().top,q=h.outerHeight(!0),f=g.offset().top,w=g.outerHeight(!0),h=Math.max(0,a.direction),p=-1<=a.ahead[0]&&1>=a.ahead[0]?parseInt(s*a.ahead[0]):parseInt(a.ahead[0]),x=-1<=a.ahead[1]&&1>=a.ahead[1]?parseInt(s*a.ahead[1]):parseInt(a.ahead[1]),h=h?x:p,m,t;switch(a.mode){case "border":c=l+(1===a.direction?-h:s+h);m=c>=f;
t=c<=f+w;c=a.turn&&(1===a.direction?c-a.distance>f:c+a.distance<f+w)?!1:a.skip?m&&t:1===a.direction?m:t;break;case "toggle":break;case "hide":break;default:m=s+l>=f-x&&(a.window?!0:v+q>=f-x),c=a.window?!1:m&&v>f+w+p,t=l<=f+w+p&&(a.window?!0:v<=f+w+p),v=a.window?!1:t&&v+q<f-x,c=a.turn&&a.multi&&(1===a.direction?l-a.distance+s>f-h:l+a.distance<f+w+h)?!1:a.skip?m&&t:1===a.direction?m&&!c:t&&!v&&a.multi}}c&&(!a.multi&&++a.count&&a.skip&&jQuery.data(g[0],a.nss.data+"-fired",!0),a.callback.apply(g[0],[b,
a.parameter,{index:a.index,length:e.length,direction:a.direction}]));if(!e.length||a.terminate&&!a.multi&&0!==a.step&&a.count>=e.length){m=0;jQuery(d).unbind(a.nss.displaytrigger).unbind(a.nss.scroll).unbind(a.nss.resize);jQuery.removeData(u,a.nss.data);!a.multi&&a.skip&&e.removeData(a.nss.data+"-fired");for(u=0;e=a.context[u];u++)m+=jQuery.data(e,a.nss.data)?1:0;!m&&!a.window&&a.expand&&jQuery(n).unbind(a.nss.scroll).unbind(a.nss.resize);return r[a.id]=y}a.end||c||!isFinite(h)||(1===a.direction?
m:t)?(a.index+=0!==a.step||c?0===a.step&&-1===a.direction?a.direction:a.step*a.direction:a.direction,a.end||arguments.callee.apply(this,arguments)):a.turn=!1}if("function"===typeof this)return arguments.callee.apply(jQuery(n),arguments);var k=window.validator instanceof Object?window.validator:!1;(k=k?k.clone({name:"jquery.displaytrigger.js",base:!0}):k)&&k.start();k&&k.test("++",1,0,"displaytrigger()");var d=jQuery.extend(!0,{},{id:0,gns:"displaytrigger",ns:y,trigger:y,callback:function(){},parameter:[],
ahead:0,beforehand:0,step:1,multi:!1,skip:!1,expand:!0,delay:300,suspend:-100,mode:"show",terminate:!0},q),p=[d.gns].concat(d.ns||[]);jQuery.extend(!0,d,{nss:{displaytrigger:p.join("."),scroll:["scroll"].concat(p.join(":")).join("."),resize:["resize"].concat(p.join(":")).join("."),data:p.join(":"),array:p},window:this[0]===n,context:this,scope:this[0]===n?jQuery(B):jQuery(this),ahead:typeof d.ahead in{string:0,number:0}?[d.ahead,d.ahead]:y,suspend:1<=d.suspend?d.suspend:0<=d.suspend?parseInt(d.delay*
d.suspend):Math.min(0,d.delay+d.suspend),index:0,length:0,count:0,height:{},direction:1,distance:0,turn:!1,end:!1,queue:[]});d.scope.length&&(d.scope.find(d.trigger).length&&arguments.length)&&A(d);k&&k.end();return this}if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;var y=void 0,n=window,B=document,r=["settings"];jQuery.fn.displaytrigger=q;jQuery.displaytrigger=q;q=null}})();
