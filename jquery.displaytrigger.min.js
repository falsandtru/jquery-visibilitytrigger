/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.4.2
 * @updated 2013/08/24
 * @author falsandtru https://github.com/falsandtru/
 * @Compressor Closure Compiler
 */
(function(){function r(r){function A(c){for(var a=0,d;d=c.context[a];a++)c.id=t.length,c.height.window=0,c.height.element=0,t.push(jQuery.extend(!0,{},c)),jQuery(d).unbind(c.nss.displaytrigger).bind(c.nss.displaytrigger,c.id,function(a,c,d){var b=t[a.data],e,k=this,m=arguments.callee;if(b){if(b.delay&&c){for(;e=b.queue.shift();)clearTimeout(e);e=setTimeout(function(){if(b){for(;e=b.queue.shift();)clearTimeout(e);z(a,b,k,c||g)}},b.delay);b.queue.push(e)}else z(a,b,k,c||g);b.suspend&&!d&&(jQuery(this).unbind(b.nss.displaytrigger),
setTimeout(function(){b&&jQuery(this).bind(b.nss.displaytrigger,b.id,m).trigger(b.nss.displaytrigger,[c,!0])},b.suspend))}}),jQuery.data(d,c.nss.data,!0),jQuery(d).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(a){(a=t[a.data])&&jQuery(this).trigger(a.nss.displaytrigger,[this])}),0===a&&jQuery(g).filter(function(){return c.context[0]===g||c.expand}).unbind(c.nss.resize).bind(c.nss.resize,c.id,function(a){(a=t[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])}).filter(function(){return c.context[0]!==
g}).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(a){(a=t[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])})}function z(c,a,d,h){var g=window,u=document,u=a.window?u:d,b=!1,e=jQuery(a.trigger,u),k=e.eq(a.index),m=jQuery(h).scrollTop(),f=a.height[h===g?"window":"element"],s=m===f?a.direction:m<f?-1:1,f=Math.abs(m-f);a.direction!==s&&(a.turn=!0,a.end=!1,a.direction=s,a.index=0>a.index?0:e.length<=a.index?e.length-1:a.index,k=e.eq(a.index));a.distance=0===f?a.distance:f;a.height[h===g?
"window":"element"]=m;a.end=k[0]?!1:a.end;-1===a.direction&&a.length<e.length&&(a.turn=!1,a.end=!1);a.length=e.length;switch(!0){case !e.length:break;case 0===a.step&&!k[0]:a.index+=-1;return;case 0>a.index:a.index=0;a.end=!0;break;case e.length<=a.index:a.index=e.length-1;a.end=!0;break;case a.beforehand>a.index&&!jQuery.data(k[0],a.nss.data+"-fired"):b=!0;break;default:if(a.end||k.is(":hidden")||!a.multi&&jQuery.data(k[0],a.nss.data+"-fired"))break;var l=jQuery(g),m=l.scrollTop(),s=l.outerHeight(!0),
l=jQuery(d),v=a.window?0:l.offset().top,r=l.outerHeight(!0),f=k.offset().top,w=k.outerHeight(!0),l=Math.max(0,a.direction),q=-1<=a.ahead[0]&&1>=a.ahead[0]?parseInt(s*a.ahead[0]):parseInt(a.ahead[0]),x=-1<=a.ahead[1]&&1>=a.ahead[1]?parseInt(s*a.ahead[1]):parseInt(a.ahead[1]),l=l?x:q,n,p;switch(a.mode){case "border":b=m+(1===a.direction?-l:s+l);n=b>=f;p=b<=f+w;b=a.turn&&(1===a.direction?b-a.distance>f:b+a.distance<f+w)?!1:a.skip?n&&p:1===a.direction?n:p;break;case "toggle":break;case "hide":break;default:n=
s+m>=f-x&&(a.window?!0:v+r>=f-x),b=a.window?!1:n&&v>f+w+q,p=m<=f+w+q&&(a.window?!0:v<=f+w+q),v=a.window?!1:p&&v+r<f-x,b=a.turn&&a.multi&&(1===a.direction?m-a.distance+s>f-l:m+a.distance<f+w+l)?!1:a.skip?n&&p:1===a.direction?n&&!b:p&&!v}}b&&(jQuery.data(k[0],a.nss.data+"-fired",!0),a.count+=1,a.callback.apply(k[0],[c,a.parameter,{index:a.index,length:e.length,direction:a.direction}]));if(!e.length||a.terminate&&!a.multi&&0!==a.step&&a.count>=e.length){n=0;jQuery(d).unbind(a.nss.displaytrigger);jQuery(h).unbind(a.nss.scroll).unbind(a.nss.resize);
jQuery.removeData(u,a.nss.data);for(u=0;p=a.context[u];u++)n+=jQuery.data(p,a.nss.data)?1:0;!n&&!a.context[0]===g&&jQuery(g).unbind(a.nss.scroll).unbind(a.nss.resize);return t[a.id]=y}a.end||b||!isFinite(l)||(1===a.direction?n:p)?(a.index+=0!==a.step||b?0===a.step&&-1===a.direction?a.direction:a.step*a.direction:a.direction,a.end||arguments.callee.apply(this,arguments)):a.turn=!1}if("function"===typeof this)return arguments.callee.apply(jQuery(g),arguments);var h=window.validator instanceof Object?
window.validator:!1;(h=h?h.clone({name:"jquery.displaytrigger.js",base:!0}):h)&&h.start();h&&h.test("++",1,0,"displaytrigger()");var d=jQuery.extend(!0,{},{id:0,gns:"displaytrigger",ns:y,trigger:y,callback:function(){},parameter:[],ahead:0,beforehand:0,step:1,multi:!1,skip:!1,expand:!0,delay:300,suspend:-100,mode:"show",terminate:!0},r),q=[d.gns].concat(d.ns||[]);jQuery.extend(!0,d,{nss:{displaytrigger:q.join("."),scroll:["scroll"].concat(q.join(":")).join("."),resize:["resize"].concat(q.join(":")).join("."),
data:q.join(":"),array:q},window:this[0]===g,context:this,scope:this[0]===g?jQuery(B):jQuery(this),ahead:typeof d.ahead in{string:0,number:0}?[d.ahead,d.ahead]:y,suspend:1<=d.suspend?d.suspend:0<=d.suspend?parseInt(d.delay*d.suspend):Math.min(0,d.delay+d.suspend),index:0,length:0,count:0,height:{},direction:1,distance:0,turn:!1,end:!1,queue:[]});d.scope.length&&(d.scope.find(d.trigger).length&&arguments.length)&&A(d);h&&h.end();return this}if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;
var y=void 0,g=window,B=document,t=["settings"];jQuery.fn.displaytrigger=r;jQuery.displaytrigger=r;r=null}})();
