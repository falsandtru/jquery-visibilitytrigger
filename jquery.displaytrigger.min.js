/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.4.0
 * @updated 2013/08/24
 * @author falsandtru https://github.com/falsandtru/
 * @Compressor Closure Compiler
 */
(function(){function u(u){function A(c){for(var a=0,b;b=c.context[a];a++)c.id=v.length,c.height.window=0,c.height.element=0,v.push(jQuery.extend(!0,{},c)),jQuery(b).unbind(c.nss.displaytrigger).bind(c.nss.displaytrigger,c.id,function(a,c,b){var d=v[a.data],e,h=this,l=arguments.callee;if(d){if(d.delay&&c){for(;e=d.queue.shift();)clearTimeout(e);e=setTimeout(function(){if(d){for(;e=d.queue.shift();)clearTimeout(e);z(a,d,h,c||f)}},d.delay);d.queue.push(e)}else z(a,d,h,c||f);d.suspend&&!b&&(jQuery(this).unbind(d.nss.displaytrigger),
setTimeout(function(){d&&jQuery(this).bind(d.nss.displaytrigger,d.id,l).trigger(d.nss.displaytrigger,[c,!0])},d.suspend))}}),jQuery.data(b,c.nss.data,!0),jQuery(b).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(a){(a=v[a.data])&&jQuery(this).trigger(a.nss.displaytrigger,[this])}),0===a&&jQuery(f).filter(function(){return c.context[0]===f||c.expand}).unbind(c.nss.resize).bind(c.nss.resize,c.id,function(a){(a=v[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])}).filter(function(){return c.context[0]!==
f}).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(a){(a=v[a.data])&&a.context.trigger(a.nss.displaytrigger,[this])})}function z(c,a,b,g){var q=window,f=document,f=b===q?f:b,d=!1,e=jQuery(a.trigger,f),h=e.eq(a.index),l=jQuery(g).scrollTop(),r=a.height[g===q?"window":"element"],t=l===r?a.direction:l<r?-1:1,r=Math.abs(l-r);a.direction!==t&&(a.turn=!0,a.end=!1,a.direction=t,a.index=0>a.index?0:e.length<=a.index?e.length-1:a.index,h=e.eq(a.index));a.distance=0===r?a.distance:r;a.height[g===q?"window":
"element"]=l;a.end=h[0]?!1:a.end;-1===a.direction&&a.length<e.length&&(a.turn=!1,a.end=!1);a.length=e.length;switch(!0){case !e.length:break;case 0===a.step&&!h[0]:a.index+=-1;return;case 0>a.index:a.index=0;a.end=!0;break;case e.length<=a.index:a.index=e.length-1;a.end=!0;break;case a.beforehand>a.index&&!jQuery.data(h[0],a.nss.data+"-fired"):d=!0;break;default:if(a.end||h.is(":hidden")||!a.multi&&jQuery.data(h[0],a.nss.data+"-fired"))break;var k=jQuery(q),l=k.scrollTop(),t=k.height(),k=jQuery(b),
r=b===q?0:k.offset().top,u=k.height(),p=h.offset().top,n=h.height(),k=Math.max(0,a.direction),w=-1<=a.ahead[0]&&1>=a.ahead[0]?parseInt(t*a.ahead[0]):parseInt(a.ahead[0]),x=-1<=a.ahead[1]&&1>=a.ahead[1]?parseInt(t*a.ahead[1]):parseInt(a.ahead[1]),k=k?x:w,m,s;switch(a.mode){case "border":d=l+(1===a.direction?-k:t+k);m=d>=p;s=d<=p+n;d=a.turn&&(1===a.direction?d-a.distance>p:d+a.distance<p+n)?!1:a.skip?m&&s:1===a.direction?m:s;break;case "toggle":break;case "hide":break;default:m=l>=p-t-x&&(b===q?!0:
r+u>p-x),s=l<=p+n+w&&(b===q?!0:0<=p+n-r+w),d=a.turn&&a.multi&&(1===a.direction?l-a.distance+t>p-k:l+a.distance<p+n+k)?!1:a.skip?m&&s:1===a.direction?m:s}}d&&(jQuery.data(h[0],a.nss.data+"-fired",!0),a.count+=1,a.callback.apply(h[0],[c,a.parameter,{index:a.index,length:e.length,direction:a.direction}]));if(!e.length||a.terminate&&!a.multi&&0!==a.step&&a.count>=e.length){m=0;jQuery(b).unbind(a.nss.displaytrigger);jQuery(g).unbind(a.nss.scroll).unbind(a.nss.resize);jQuery.removeData(f,a.nss.data);for(f=
0;s=a.context[f];f++)m+=jQuery.data(s,a.nss.data)?1:0;!m&&!a.context[0]===q&&jQuery(q).unbind(a.nss.scroll).unbind(a.nss.resize);return v[a.id]=y}a.end||d||!isFinite(k)||(1===a.direction?m:s)?(a.index+=0!==a.step||d?0===a.step&&-1===a.direction?a.direction:a.step*a.direction:a.direction,a.end||arguments.callee.apply(this,arguments)):a.turn=!1}if("function"===typeof this)return arguments.callee.apply(jQuery(f),arguments);var g=window.validator instanceof Object?window.validator:!1;(g=g?g.clone({name:"jquery.displaytrigger.js",
base:!0}):g)&&g.start();g&&g.test("++",1,0,"displaytrigger()");var b=jQuery.extend(!0,{},{id:0,gns:"displaytrigger",ns:y,trigger:y,callback:function(){},parameter:[],ahead:0,beforehand:0,step:1,multi:!1,skip:!1,expand:!0,delay:300,suspend:-100,mode:"show",terminate:!0},u),n=[b.gns].concat(b.ns||[]);jQuery.extend(!0,b,{nss:{displaytrigger:n.join("."),scroll:["scroll"].concat(n.join(":")).join("."),resize:["resize"].concat(n.join(":")).join("."),data:n.join(":"),array:n},context:this,scope:this[0]===
f?jQuery(B):jQuery(this),ahead:typeof b.ahead in{string:0,number:0}?[b.ahead,b.ahead]:b.ahead,suspend:1<=b.suspend?b.suspend:0<=b.suspend?parseInt(b.delay*b.suspend):Math.min(0,b.delay+b.suspend),index:0,length:0,count:0,height:{},direction:1,distance:0,turn:!1,end:!1,queue:[]});b.scope.length&&(b.scope.find(b.trigger).length&&arguments.length)&&A(b);g&&g.end();return this}if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;var y=void 0,f=window,B=document,v=["settings"];jQuery.fn.displaytrigger=
u;jQuery.displaytrigger=u;u=null}})();
