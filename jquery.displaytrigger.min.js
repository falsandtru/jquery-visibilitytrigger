/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.1.14
 * @updated 2013/04/27
 * @author falsandtru  http://fat.main.jp/  http://sa-kusaku.sakura.ne.jp/
 * @Compressor Closure Compiler
 */
(function(){function m(m){function v(b,c,r){var p=window,a=document,e=c===p?a:c,d=!1,j,g;if(a=n[b.data]){j=jQuery(a.trigger,e);g=j.eq(a.index);switch(!0){case !j.length:break;case 0===a.step&&!g[0]:a.index+=-1;return;case 0>a.index:return a.index=0,a.end=!0,arguments.callee.apply(c,arguments);case a.index>=j.length:return a.index=j.length-1,a.end=!0,arguments.callee.apply(c,arguments);case a.beforehand>a.index&&!jQuery.data(g[0],a.nss.data+"-fired"):d=!0;break;case a.skip&&("none"===g.css("display")||
"hidden"===g.css("visibility")):break;default:var k=jQuery(r).scrollTop(),h=a.height[r===p?"window":"element"],f=k===h?a.direction:k<h?-1:1,h=-1===f?h-k:k-h;a.direction!==f&&(a.turn=!0,a.end=!1,a.direction=f,g=j.eq(a.index));a.distance=0===h?a.distance:h;a.height[r===p?"window":"element"]=k;if(a.end)break;var k=jQuery(p).scrollTop(),h=g.offset().top,m=jQuery(p).height(),s=g.height(),l=0>f?0:1,l=-1<=a.ahead[l]&&1>=a.ahead[l]?parseInt(s*a.ahead[l]):parseInt(a.ahead[l]),t=k>=h-m-l,u=k<=h+s+l;if(a.multi||
!jQuery.data(g[0],a.nss.data+"-fired"))d=a.turn&&a.multi&&(-1===f?k+a.distance<=h+s+l:k-a.distance>=h-m-l)?!1:a.skip?t&&u:-1===f?u:t;if(!d&&!(-1===a.direction?u:t)){a.turn=!1;return}}d&&g[0]!==q&&(jQuery.data(g[0],a.nss.data+"-fired",!0),a.count+=1,a.callback.apply(g[0],[b,a.parameter,{index:a.index,direction:a.direction}]));if(!j.length||a.terminate&&!a.multi&&0!==a.step&&a.count>=j.length){d=0;jQuery(c).unbind(a.nss.displaytrigger);jQuery(r).unbind(a.nss.scroll).unbind(a.nss.resize);jQuery.removeData(e,
a.nss.data);for(e=0;j=a.context[e];e++)d+=jQuery.data(j,a.nss.data)?1:0;!d&&!a.context[0]===p&&jQuery(p).unbind(a.nss.scroll).unbind(a.nss.resize);n[a.id]=q}else return a.index+=0===a.step&&!d?a.direction:0===a.step&&-1===a.direction?a.direction:a.step*a.direction,a.end?q:arguments.callee.apply(c,arguments)}}if("function"===typeof this)return arguments.callee.apply(jQuery(f),arguments);var e="object"===typeof window.validator?window.validator:!1;(e=e?e.clone({name:"jquery.displaytrigger.js",base:!0}):
e)&&e.start();e&&e.test(1,1,0,"plugin load");var c=jQuery.extend(!0,{},{id:0,gns:"displaytrigger",ns:q,trigger:q,callback:function(){},parameter:[],ahead:0,beforehand:0,step:1,multi:!1,skip:!1,expand:!0,delay:300,terminate:!0,reset:!0},m),d=[c.gns].concat(c.ns||[]);c.reset&&jQuery.extend(!0,c,{nss:{displaytrigger:d.join("."),scroll:["scroll"].concat(d.join(":")).join("."),resize:["resize"].concat(d.join(":")).join("."),data:d.join(":"),array:d},context:this,scope:this[0]===f?jQuery(w):jQuery(this),
index:0,ahead:typeof c.ahead in{string:1,number:1}?[c.ahead,c.ahead]:c.ahead,count:0,height:{},direction:1,distance:0,turn:!1,end:!1,reset:!1,queue:[]});if(c.scope.length&&c.scope.find(c.trigger).length&&arguments.length)for(var b=c,c=0;d=b.context[c];c++)b.id=n.length,b.height.window=0,b.height.element=0,n.push(jQuery.extend(!0,{},b)),jQuery(d).unbind(b.nss.displaytrigger).bind(b.nss.displaytrigger,b.id,function(b,c){var d=n[b.data],e,a=this;if(!d.delay||!c)v(b,a,c||f);else{for(;e=d.queue.shift();)clearTimeout(e);
e=setTimeout(function(){if(d){for(;e=d.queue.shift();)clearTimeout(e);v(b,a,c||f)}},d.delay);d.queue.push(e)}}),jQuery.data(d,b.nss.data,!0),jQuery(d).unbind(b.nss.scroll).bind(b.nss.scroll,b.id,function(b){b=n[b.data];jQuery(this).trigger(b.nss.displaytrigger,[this])}),0===c&&jQuery(f).filter(function(){return b.context[0]===f||b.expand}).unbind(b.nss.resize).bind(b.nss.resize,b.id,function(b){b=n[b.data];b.context.trigger(b.nss.displaytrigger,[this])}).filter(function(){return b.context[0]!==f}).unbind(b.nss.scroll).bind(b.nss.scroll,
b.id,function(b){b=n[b.data];b.context.trigger(b.nss.displaytrigger,[this])});e&&e.end();return this}if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;var q=void 0,f=window,w=document,n=["settings"];jQuery.fn.displaytrigger=m;jQuery.displaytrigger=m;m=null}})();
