/*
 * 
 * displaytrigger
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.1.2
 * @updated 2013/04/12
 * @author falsandtru  http://fat.main.jp/  http://sa-kusaku.sakura.ne.jp/
 * @Compressor Closure Compiler
 */
(function(){function j(j){function t(c,b,d){var f=window,a=document,h=b===f?a:b,l=!1,g,m;if(a=e[c.data]){g=jQuery(a.trigger,h);m=g.eq(a.index);switch(!0){case !g.length:break;case 0>a.index:return a.index=0,a.end=!0,e[a.id]=a,a.terminate?null:arguments.callee.apply(b,arguments);case a.index>=g.length:return a.index=g.length-1,a.end=!0,e[a.id]=a,a.terminate?null:arguments.callee.apply(b,arguments);case a.beforehand>a.index&&!jQuery.data(m.get(0),a.nss.data+"-fired"):l=!0;break;case a.once&&jQuery.data(m.get(0),
a.nss.data+"-fired"):break;default:var n=jQuery(d).scrollTop(),k=a.height[d===f?"window":"element"],j=n===k?a.direction:n<k?-1:1,k=-1===j?k-n:n-k;a.direction!==j&&(a.turn=!0,a.end=!1,a.direction=j,m=g.eq(a.index));a.distance=0===k?a.distance:k;a.height[d===f?"window":"element"]=n;if(a.end)break;var l=jQuery(f).scrollTop(),p=m.offset().top,q=jQuery(f).height(),s=m.height(),r=-1<a.ahead&&1>a.ahead?s*a.ahead:a.ahead,n=l>=p-q-r,k=l<=p+s+r;l=a.turn&&!a.once&&(-1===j?l+a.distance<=p+s+r:l-a.distance>=p-
q-r)?!1:a.skip?n&&k:-1===j?k:n;if(!l&&!(-1===a.direction?k:n)){a.turn=!1;e[a.id]=a;return}}l&&(a.once?jQuery.data(m.get(0),a.nss.data+"-fired",!0):null,a.callback.apply(m.get(0),[c,a.parameter,a.index,a.direction]));if(a.terminate&&(l&&(0===a.index&&0>a.step||a.index===g.length-1&&0<a.step)||!g.length)){g=0;d===f?null:jQuery(d).unbind(a.nss.scroll);jQuery(b).unbind(a.nss.displaytrigger).unbind(a.nss.scroll);jQuery.removeData(h,a.nss.data);for(h=0;m=a.scope[h];h++)g+=jQuery.data(m,a.nss.data)?1:0;
g?null:jQuery(f).unbind(a.nss.scroll).unbind(a.nss.resize);e[a.id]=void 0}else return a.index+=-1===a.direction?-a.step:a.step,e[a.id]=a,a.end?null:arguments.callee.apply(b,arguments)}}if("function"===typeof this)return arguments.callee.apply(jQuery(window),arguments);var h=window,q=document,b=jQuery.extend(!0,{},{id:0,gns:"displaytrigger",ns:void 0,trigger:void 0,callback:function(){},parameter:[],ahead:0,beforehand:0,index:0,step:1,once:!0,skip:!1,expand:!0,delay:300,terminate:!0,reset:!0},j);b.reset&&
jQuery.extend(!0,b,{nss:{scroll:["scroll",b.gns+(b.ns?":"+b.ns:"")].join("."),displaytrigger:""+(b.gns+(b.ns?"."+b.ns:"")),resize:["resize",b.gns+(b.ns?":"+b.ns:"")].join("."),data:b.gns+(b.ns?":"+b.ns:"")},scope:this.get(0)===h?jQuery(q):jQuery(this),index:0,height:{},direction:1,distance:0,turn:!1,end:!1,reset:!1,queue:[]});if(!b.scope.length||!b.scope.find(b.trigger).length||!arguments.length)return this;var c=b;c.height.window=0;jQuery(h).unbind(c.nss.resize);for(var b=0,p;p=c.scope[b];b++)c.height.element=
0,c.id=e.length,e.push(jQuery.extend(!0,{},c)),jQuery.data(p,c.nss.data,c.id),jQuery(p===q?h:p).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(b){b=e[b.data];jQuery(this).trigger(b.nss.displaytrigger,[this])}).unbind(c.nss.displaytrigger).bind(c.nss.displaytrigger,c.id,function(b,c){var d=e[b.data],f,a;a=this;d.delay?(f=setTimeout(function(){for(;f=d.queue.shift();)clearTimeout(f);e[d.id]=d;t(b,a,c||h)},d.interval),d.queue.push(f),e[d.id]=d):t(b,a,c||h)});jQuery(h).unbind(c.nss.resize).bind(c.nss.resize,
c.id,function(b){b=e[b.data];b.scope.trigger(b.nss.displaytrigger,[this])}).filter(function(){return c.expand&&q!==c.scope.get(0)}).unbind(c.nss.scroll).bind(c.nss.scroll,c.id,function(b){b=e[b.data];b.scope.trigger(b.nss.displaytrigger,[this])});return this}if("undefined"!==typeof window.jQuery){window.undefined=void 0;jQuery=window.jQuery;var e=["settings"];window.jQuery.fn.displaytrigger=j;window.jQuery.displaytrigger=j;j=null}})();
